---
title: 积分与微分方程
mathjax: true
tags: []
categories:
  - article
  - 数学
  - 高等数学
  - 高数复习
date: 2020-01-01 00:00:00
---

## 积分与微分方程

### 积分

#### 不定积分

##### 不定积分的三种求法

- 第一换元法（凑微分法）

<!-- $\global \def {\d}{\mathop{}\!\mathrm{d}}$ -->
<!-- $\global \def $ -->

$$
\int g(\psi(x))\psi'(x) \mathop{}\!\mathrm{d} x = \int g(u) \mathop{}\!\mathrm{d} u \Big|_{u = \psi(x)}
$$

- 第二换元法

令 $x = \psi(t)$

$$
\int g(x) d x = \int g(\psi(x)) d \psi(x) = \int g(\psi(x)) \psi'(x) d x
$$

**ps:** 此法要求 $x = \psi (u)$ 为单调可导函数，定积分要注意代换之后的积分范围会根据代换函数的增减性调整，切记得将 $u = \psi^{-1}(x)$ 回代；
常见代换方法：

1. 三角函数代换；
2. 根式代换；
3. 倒代换；
4. 复杂函数的直接代换（比如反三角函数和对数函数等）；

- 分部积分法-选取优先级（反对幂三（指）指（三））

**ps:**分布积分经常创造出积分再现或者积分抵消的情形；

$$
\int uv' \mathop{}\!\mathrm{d} x = uv - \int v' \mathop{}\!\mathrm{d} u
$$

##### 基本积分公式

1. 有理函数

   $$
   \begin{aligned}
   &\int x^a \mathop{}\!\mathrm{d} x = \frac{x^{a+1}}{a+1} + C(a \neq  -1); &
   &\int \frac{1}{x} \mathop{}\!\mathrm{d} x = \ln|x| \mathop{}\!\mathrm{d} x \\
   &\int a^x \mathop{}\!\mathrm{d} x = \frac{a^x}{\ln a} \mathop{}\!\mathrm{d} x + C(a > 0, a \neq 1); &
   &\int e^x \mathop{}\!\mathrm{d} x = e^x + C; \\
   \end{aligned}
   $$

2. 三角函数
   $$
   \begin{aligned}
   &\int \sin x \mathop{}\!\mathrm{d} x = - \cos x + C; &
   &\int \cos \mathop{}\!\mathrm{d} x = \sin x + C; \\
   &\int \tan x \mathop{}\!\mathrm{d} x = -\ln |\cos x| + C; &
   &\int \cot x \mathop{}\!\mathrm{d} x = \ln \sin x + C; \\
   &\int \sec x \mathop{}\!\mathrm{d} x = \ln |\sec x + \tan x| + C; &
   &\int \csc x \mathop{}\!\mathrm{d} x = \ln |\csc x - \cot x| + C; \\
   &\int \sec^2 x \mathop{}\!\mathrm{d} x = \tan x + C &
   &\int \csc^2 x \mathop{}\!\mathrm{d} x = -\cot x + \\
   &\int \sec x \tan x \mathop{}\!\mathrm{d} x = \sec x + C&
   &\int \csc x \cot x \mathop{}\!\mathrm{d} x = -\csc x + C \\
   &\int \cos^2 x \mathop{}\!\mathrm{d} x = \frac{x}{2} - \frac{\sin 2x}{4} + C&
   &\int \sin^2 x \mathop{}\!\mathrm{d} x = \frac{x}{2} + \frac{\sin 2x}{4} + C\\
   &\int \tan^2 x \mathop{}\!\mathrm{d} x = \tan x - x + C&
   &\int \cot^2 x \mathop{}\!\mathrm{d} x = - \cot x - x + C\\
   \end{aligned}
   $$

$\sin^2 x , \cos^2 x$ 通过降幂公式 $\cos 2x = 2\cos^2 x - 1 = 1 - 2\sin^2 x$ ，将幂次降下来再进行积分；
$\tan^2 x , \cot^2 x$ 通过切割转换公式 $\tan^2 = \sec^2 x - 1, \cot^2 = \csc^2 x - 1$ ，将正余切的积分转换为正余割的幂再进行积分；

1. 根式
   $$
   \begin{aligned}
   &\int \frac{\mathop{}\!\mathrm{d} x}{\sqrt{1 - x^2}} = \arcsin x + C&
   &\int \frac{\mathop{}\!\mathrm{d} x}{\sqrt{a^2 - x^2}} = \arcsin \frac{x}{a} + C\\
   &\int \frac{\mathop{}\!\mathrm{d} x}{1 + x^2} = \arctan x + C&
   &\int \frac{\mathop{}\!\mathrm{d} x}{a^2 + x^2} = \frac{1}{a} \arctan \frac{x}{a} + C\\
   &\int \frac{\mathop{}\!\mathrm{d} x}{x^2 - a^2} = \frac{1}{2a} \ln|\frac{x - a}{x + a}| + C\\
   &\int \frac{\mathop{}\!\mathrm{d} x}{\sqrt{x^2 \pm a^2}} = \ln(x + \sqrt{a^2 \pm x^2}) + C\\
   &\int \sqrt{a^2 - x^2} \mathop{}\!\mathrm{d} x = \frac{a^2}{2} \arcsin \frac{x}{a} + \frac{x}{2} \sqrt{a^2 - x^2} + C
   \end{aligned}
   $$

#### $\int^{x}_{a} f(x)$ 、 $f(x)$ 、 $f'(x)$ 的关系

| $f(x)$   | $\int^{x}_{0}f(t) \mathop{}\!\mathrm{d} t$                     | $\int^{x}_{a}f(t) \mathop{}\!\mathrm{d} t$ | $f'(x)$  |
| -------- | -------------------------------------------------------------- | ------------------------------------------ | -------- |
| 周期函数 | 周期函数(条件：$\int^{T}_{0}f(t) \mathop{}\!\mathrm{d} t = 0$) | 周期函数                                   | 周期函数 |
| 奇函数   | 偶函数                                                         | 偶函数                                     | 偶函数   |
| 偶函数   | 奇函数                                                         | 不确定                                     | 奇函数   |

#### 定积分

##### 积分中值定理

$$
\int^{a}_{b} f(x) \mathop{}\!\mathrm{d} x = f(\xi) (b - a)
$$

##### 重要公式总结

###### 区间再现公式

$$
\begin{aligned}
  &\int^{a}_{b} f(x) \mathop{}\!\mathrm{d} x = \int^{a}_{b} f(a + b - x) \mathop{}\!\mathrm{d} x\\
  &\int^{a}_{b} f(x) \mathop{}\!\mathrm{d} x = \frac{1}{2} \int^{b}_{a} \lbrack f(x) + f(a + b - x) \rbrack \mathop{}\!\mathrm{d} x\\
  &\int^{b}_{a} f(x) \mathop{}\!\mathrm{d} x = \int^{\frac{a + b}{2}}_{a} \lbrack f(x) + f(a + b - x) \rbrack \mathop{}\!\mathrm{d} x\\
\end{aligned}
$$

###### 华氏公式（点火公式）

$$
\begin{aligned}
  &\int^{\frac{\pi}{2}}_{0} \sin^n x \mathop{}\!\mathrm{d} x = \int^{\frac{\pi}{2}}_{0} \cos^n x \mathop{}\!\mathrm{d} x =
  \begin{cases}
    \dfrac{n - 1}{n} \cdot \dfrac{n - 3}{n - 2} \cdot \cdots \dfrac{2}{3} \cdot 1, \text{n > 1 and n is odd}\\
    \dfrac{n - 1}{n} \cdot \dfrac{n - 3}{n - 2} \cdot \cdots \dfrac{2}{3} \cdot 1, \text{n > 0 and n is even}\\
  \end{cases}\\
  &\int^{\pi}_{0} \sin^n x \mathop{}\!\mathrm{d} x =
    \begin{cases}
      2 \cdot \dfrac{n - 1}{n} \cdot \dfrac{n - 3}{n - 2} \cdot \cdots \cdot \dfrac{2}{3} \cdot 1, \text{n > 1 and n is odd}\\
      2 \cdot \dfrac{n - 1}{n} \cdot \dfrac{n - 3}{n - 2} \cdot \cdots \cdot \dfrac{1}{2} \cdot \frac{\pi}{2}, \text{n > 0 and n is even}
    \end{cases}\\
  &\int^{\pi}_{0} \cos^n x \mathop{}\!\mathrm{d} x =
  \begin{cases}
    0, \text{n > 0 and n is odd}\\
    2 \cdot \dfrac{n - 1}{n} \cdot \dfrac{n - 3}{n - 2} \cdot \cdots \cdot \dfrac{1}{2} \cdot \dfrac{\pi}{2}, \text{n > 0 and n is even}
  \end{cases}\\
  &\int^{2\pi}_{0} \sin^n x \mathop{}\!\mathrm{d} x =
  \begin{cases}
    0, \text{n > 0 and n is odd}\\
    4 \cdot \dfrac{n - 1}{n} \cdot \dfrac{n - 3}{n - 2} \cdot \cdots \cdot \dfrac{1}{2} \cdot \dfrac{\pi}{2}, \text{n > 0 and n is even}
  \end{cases}\\
  &\int^{2\pi}_{0} \cos^n x \mathop{}\!\mathrm{d} x = \int^{2\pi}_{0} \sin^n x \mathop{}\!\mathrm{d} x =
  \begin{cases}
    0, \text{n > 0 and n is odd}\\
    4 \cdot \dfrac{n - 1}{n} \cdot \dfrac{n - 3}{n - 2} \cdot \cdots \cdot \dfrac{1}{2} \cdot \dfrac{\pi}{2}, \text{n > 0 and n is even}
  \end{cases}\\
\end{aligned}
$$

###### 其他含有三角函数的公式

$$
\begin{aligned}
  &\int^{\pi}_{0} x f(\sin x) \mathop{}\!\mathrm{d} x = \dfrac{\pi}{2} \int^{\pi}_{0} f(\sin x ) \mathop{}\!\mathrm{d} x\\
  &\int^{\pi}_{0} x f(\sin x) \mathop{}\!\mathrm{d} x = \pi \int^{\frac{\pi}{2}}_{0} f(\sin x) \mathop{}\!\mathrm{d} x\\
  &\int^{\frac{\pi}{2}}_{0} f(\sin x) \mathop{}\!\mathrm{d} x = \int^{\frac{\pi}{2}}_{0} f(\cos x) \mathop{}\!\mathrm{d} x\\
  &\int^{\frac{\pi}{2}}_{0} f(\sin x, \cos x) \mathop{}\!\mathrm{d} x = \int^{\frac{\pi}{2}}_{0} f(\cos x, \sin x) \mathop{}\!\mathrm{d} x
\end{aligned}
$$

###### 区间简化公式

$$
\begin{aligned}
  &\int^{b}_{a} f(x) \mathop{}\!\mathrm{d} x = \int^{\frac{\pi}{2}}_{-\frac{\pi}{2}} f(\dfrac{a + b}{2} + \frac{b - a}{2} \sin t) \cdot \frac{b - a}{2} \cos t \mathop{}\!\mathrm{d} t\\
  &\int^{b}_{a} f(x) \mathop{}\!\mathrm{d} x = \int^{1}_{0} f\lbrack a + (b - a)t \rbrack \mathop{}\!\mathrm{d} t\\
  &\int^{a}_{-a} f(x) \mathop{}\!\mathrm{d} x = \int^{a}_{0} \lbrack f(x) + f(-x) \rbrack \mathop{}\!\mathrm{d} x\\
\end{aligned}
$$

#### 变限积分

1. 直接求导

$$
\int^{f(x)}_{0} g(t) \mathop{}\!\mathrm{d} t \Rightarrow g(f(x))f'(x)
$$

2. 换元求导

$$
\int^{x + f(x)}_{x} g(t - x) \mathop{}\!\mathrm{d} t \xRightarrow{u = t - x} = \int^{f(x)}_{0} g(u) \mathop{}\!\mathrm{d} u
$$

3. 拆分求导，一般是对称区间奇函数或者绝对值等等分段函数
4. 换序积分，画出积分范围，再换序

**注意常考**：

1. 反函数的导函数关系
2. 原函数与积分的关系
3. 积分中值定理
4. 拉格朗日中值定理
5. 含 $e^x$ 积分的处理，导数乘法公式的逆用

#### 反常积分与 $\varGamma$ 函数

### 微分方程

#### 可分离变量的微分方程

$$
\frac{\mathop{}\!\mathrm{d} y}{\mathop{}\!\mathrm{d} x} = P(x) y \rightarrow
\frac{\mathop{}\!\mathrm{d} y}{y} = P(x) \mathop{}\!\mathrm{d} x \to
\ln y = \int P(x) \mathop{}\!\mathrm{d} x \to
y = C e ^{\int P(x) \mathop{}\!\mathrm{d} x}
$$

#### 齐次微分方程

$$
\begin{aligned}
& \frac{\mathop{}\!\mathrm{d} y}{\mathop{}\!\mathrm{d} x} = \phi(\frac{y}{x}) \xRightarrow{u = \frac{y}{x}}
  \frac{\mathop{}\!\mathrm{d} y}{\mathop{}\!\mathrm{d} x} = x \frac{\mathop{}\!\mathrm{d} u}{\mathop{}\!\mathrm{d} x} + u = \phi(u) \\
& \Rightarrow \frac{\mathop{}\!\mathrm{d} u}{u - \phi (u)} = \frac{\mathop{}\!\mathrm{d} x}{x} \\
& \Rightarrow x = C e ^{\int \frac{\mathop{}\!\mathrm{d} u}{u - \phi (u)}}, u = \frac{y}{x}
\end{aligned}
$$

##### 可化为齐次的微分方程

$$
\frac{\mathop{}\!\mathrm{d} y}{\mathop{}\!\mathrm{d} x} = \frac{a_1 x + b_1 y + c_1}{a_2 x = b_2 y + c_2} \xRightarrow{x = X + k_1, y = Y + k_2}
\frac{\mathop{}\!\mathrm{d} y}{\mathop{}\!\mathrm{d} x} = \frac{\mathop{}\!\mathrm{d} Y}{\mathop{}\!\mathrm{d} X} = \frac{a_1 X + b_1 Y}{a_2 X + b_2 Y} \xRightarrow{u = \frac{Y}{X}}
\frac{\mathop{}\!\mathrm{d} Y}{\mathop{}\!\mathrm{d} X} = \frac{b_1 u + a_1}{b_2 u + a_2}
$$

上述 $k_1, k_2$ 的取值能够将常数项 $c_1, c_2$ 化为 0，接下来的步骤和齐次线性方程的解法一致了。

#### 一阶线性微分方程

有以下一阶线性微分方程：

$$
\frac{\mathop{}\!\mathrm{d} y}{\mathop{}\!\mathrm{d} x} + P(x)y = Q(x)
$$

令 $Q(x) = 0$ 得到**非齐次微分方程对应的齐次方程**：

$$
\frac{\mathop{}\!\mathrm{d} y}{\mathop{}\!\mathrm{d} x} = - P(x) y
$$

齐次方程的通解：

$$
\frac{\mathop{}\!\mathrm{d} y}{\mathop{}\!\mathrm{d} x} + P(x)y = 0 \Rightarrow
\frac{\mathop{}\!\mathrm{d} y}{y} = -P(x) \mathop{}\!\mathrm{d} x \Rightarrow y = Ce ^{- \int P(x) \mathop{}\!\mathrm{d} x}
$$

常数变易法解出**非齐次微分方程**的通解：

令 $y = u e ^{- \int P(x) \mathop{}\!\mathrm{d} x}$,

$$
\begin{aligned}
\frac{\mathop{}\!\mathrm{d} y}{\mathop{}\!\mathrm{d} x} & = -P(x) u e ^{- \int P(x) \mathop{}\!\mathrm{d} x} + \frac{\mathop{}\!\mathrm{d} u}{\mathop{}\!\mathrm{d} x} e ^{-\int P(x) \mathop{}\!\mathrm{d} x} \\
& = Q(x) - P(x) y \\
& = Q(x) - P(x) u e ^{-\int P(x) \mathop{}\!\mathrm{d} x} \\ \Longrightarrow
& \frac{\mathop{}\!\mathrm{d} u}{\mathop{}\!\mathrm{d} x} = Q(x) e ^{\int P(x) \mathop{}\!\mathrm{d} x} \\ \Longrightarrow
& u = \int Q(x) e ^{\int P(x) \mathop{}\!\mathrm{d} x} \mathop{}\!\mathrm{d} x + C \\ \Longrightarrow
& y = \big( \int Q(x) e ^{\int P(x) \mathop{}\!\mathrm{d} x} \mathop{}\!\mathrm{d} x + C \big) e ^{- \int P(x) \mathop{}\!\mathrm{d} x}
\end{aligned}
$$

#### 伯努利方程

$$
\begin{aligned}
& \frac{\mathop{}\!\mathrm{d} y}{\mathop{}\!\mathrm{d} x} + P(x)y = Q(x)y ^{n} \\ \Rightarrow
& y^{-n} \frac{\mathop{}\!\mathrm{d} y}{\mathop{}\!\mathrm{d} x} + P(x) y^{1-n} = Q(x) \\ \Rightarrow
& \frac{\mathop{}\!\mathrm{d} y^{1-n}}{\mathop{}\!\mathrm{d} x} + (1-n)P(x)y^{1-n} = (1-n)Q(x)
\end{aligned}
$$

最后化成了关于 $y^{1-n}$ 和 $x$ 的微分方程，一阶线性微分方程的通解求法，可以求出 $y^{1-n}$ 的通解，进而求出 $y$ 的通解。

#### 可降阶的高阶微分方程

##### $y^{(n)} = f(x)$ 型

无限求积分直到解出来

$$
y = \int \Big( \int \dots \big( \int (\int y ^{(n)} \mathop{}\!\mathrm{d} x + C_1 ) \mathop{}\!\mathrm{d} x + C_2 \big) + \dots \Big) + C_{n-1}
$$

##### $y'' = f(x, y')$ 型

该类型的微分方程右端不显含未知函数 $y$ ，我们设 $y' = p$，则有

$$
p' = f(x, p)
$$

解该一阶微分方程得到：

$$
\begin{aligned}
p &= \varphi(x, C_1) \\ \Rightarrow
\frac{\mathop{}\!\mathrm{d} y}{\mathop{}\!\mathrm{d} x} &= \varphi(x, C_1) \mathop{}\!\mathrm{d} x \\ \Rightarrow
y &= \int \varphi(x, C_1) \mathop{}\!\mathrm{d} x
\end{aligned}
$$

##### $y'' = f(y, y')$ 型

该方程不显含自变量 $x$ 我们令 $p = y'$ 将关于 $y$ 的二阶微分方程转换成关于 $p$ 的一阶微分方程

$$
y'' = \frac{\mathop{}\!\mathrm{d} y'}{\mathop{}\!\mathrm{d} y} \cdot \frac{\mathop{}\!\mathrm{d} y}{\mathop{}\!\mathrm{d} x} = p \cdot \frac{\mathop{}\!\mathrm{d} p}{\mathop{}\!\mathrm{d} x} = f(y, p)
$$

这是一个关于 $p$ 和 $y$ 的一阶微分方程，假设其通解为：

$$
\begin{aligned}
y' = p &= \varphi(y, C_1) \\ \Rightarrow
\int \frac{\mathop{}\!\mathrm{d} y}{\varphi (y, C_1)} &= x + C_2
\end{aligned}
$$

#### 高阶微分方程

##### 线性微分方程解的结构

考虑一个二阶线性微分方程：

$$
\tag{1} y'' + P(x)y' + Q(x)y = 0
$$

**定理 1** 如果函数 $y_1(x)$ 和 $y_2(x)$ 是方程 $(1)$ 的解，那么

$$
y = C_1 y_1(x) + C_2 y_2(x)
$$

也是方程 $(1)$ 的解，其中 $C_1, C_2$ 是任意常数。

线性相关的概念：

> 设函数 $y_1(x), y_2(x), \dots, y_n(x)$ 为定义在区间 $I$ 上的 $n$ 个函数，如果存在 $n$ 个不全为零的常数 $k_1, k_2, k_3, \dots, k_n$ 使得
> $$k_1 y_1(x) + k_2 y_2(x) + \dots + k_n y_n(x) \equiv 0$$
> 我们说这 $n$ 个函数 $y_1(x), y_2(x), y_3(x), \dots, y_n(x)$ **线性相关**，否则称为**线性无关**.

**定理 2** 如果 $y_1(x)$ 和 $y_2(x)$ 是方程 $(1)$ 的两个线性无关特解，那么

$$
y = C_1 y_1(x) + C_2 y_2(x) \quad (C_1, C_2 \; \text{are constants})
$$

就是方程 $(1)$ 的特解。

##### ... 未完待续

#### 常系数齐次线性微分方程

#### 常系数非齐次线性微分方程

#### 欧拉方程
